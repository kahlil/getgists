/*! jQuery GetGists Plugin - v0.1.0 - 2012-10-12
* https://github.com/tvooo/getgists
* Copyright (c) 2012 Tim von Oldenburg; Licensed MIT */
(function(e,t,n,r){"use strict";function s(t,n){this.element=t,this.options=e.extend({},e.fn[i].defaults,n),this._defaults=e.fn[i].defaults,this._name=i}var i="getGists";n._write=n.write,n.write=function(e){var t,r,i;if(e.indexOf('<div id="gist-')!==0){e.indexOf("https://gist.github.com/stylesheets/gist/embed.css")===-1&&n._write(e);return}t=/<div id=\"gist-(\d+)/.exec(e)[1],r=n.querySelector('script[src="https://gist.github.com/'+t+'.js"]'),i=n.createElement("div"),i.innerHTML=e,r.parentNode.innerHTML=e},s.prototype={insertGistCSS:function(){e('link[href="https://gist.github.com/stylesheets/gist/embed.css"]').length||e("<link>").attr({rel:"stylesheet",href:"https://gist.github.com/stylesheets/gist/embed.css"}).appendTo(e("head"))},fetchGists:function(t,n){var r,i,s;t.user?r="/users/"+t.user+"/gists":e.error("No user name provided."),e.ajax({method:"get",dataType:"json",url:"https://api.github.com"+r,success:e.proxy(function(r,o,u){i=e.grep(r,e.proxy(function(e,n){return this.filter(t,e)},this)),s=i.slice(0,t.count),n(s)},this),error:function(e,t,n){return n}})},fetchGist:function(){e.error("Not yet implemented")},filter:function(e,t){if(e.language!==r&&typeof e.language=="string"&&e.language.length){var n,i=!1;for(n in t.files)t.files[n].language&&t.files[n].language.toLowerCase()===e.language.toLowerCase()&&(i=!0);if(!i)return!1}return e.keyword!==r&&typeof e.keyword=="string"&&e.keyword.length&&t.description.toLowerCase().indexOf(e.keyword.toLowerCase())===-1?!1:!0},list:function(t){return this.fetchGists(t,e.proxy(function(e){t.success&&t.success(e)},this)),e},embed:function(){return this.insertGistCSS(),this.fetchGists(this.options,e.proxy(function(t){t.forEach(e.proxy(function(t){var r,i;i=n.createElement("script"),i.type="text/javascript",i.src="https://gist.github.com/"+t.id+".js",r=this.options.outputElem==="li"?e("<li>"):e("<div>"),this.options.outputClass&&r.addClass(this.options.outputClass),r.get(0).appendChild(i),this.element.appendChild(r.get(0))},this)),this.options.success&&this.options.success()},this)),this}},e.fn[i]=function(t){if(this instanceof e)return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,(new s(this,t)).embed())});s.prototype.list(e.extend({},e.fn[i].defaults,t))},e.fn[i].defaults={count:10,outputElem:"div",success:function(){}}})(jQuery,window,document);